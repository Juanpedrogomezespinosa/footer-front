<main class="flex-1 w-full max-w-screen-xl mx-auto p-4 sm:p-6 lg:p-8">
  <div class="flex flex-col lg:flex-row gap-8">
    <aside class="lg:w-1/4 xl:w-1/5">
      <div class="flex flex-col gap-4 sticky top-28">
        <div class="flex items-center gap-3 mb-4">
          <label for="avatarInput" class="relative cursor-pointer group">
            <div
              class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-12"
              [ngStyle]="avatarStyle"
              data-alt="User avatar"
            ></div>

            <div
              class="absolute inset-0 size-12 rounded-full bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"
            >
              <span class="material-symbols-outlined text-white">edit</span>
            </div>
          </label>

          <input
            type="file"
            id="avatarInput"
            class="hidden"
            accept="image/png, image/jpeg, image/gif"
            (change)="onFileSelect($event)"
          />

          <div class="flex flex-col overflow-hidden">
            <h1
              class="text-text-light-primary text-base font-semibold leading-normal"
            >
              Bienvenido, {{ user?.username || "Cargando..." }}
            </h1>
            <p
              class="text-text-light-secondary text-sm font-normal leading-normal truncate"
            >
              {{ user?.email || "Cargando..." }}
            </p>
          </div>
        </div>

        <div *ngIf="selectedAvatarPreview" class="flex items-center gap-2">
          <button
            (click)="uploadAvatar()"
            [disabled]="uploadingAvatar"
            class="flex-1 text-xs px-2 py-1.5 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-50"
          >
            {{ uploadingAvatar ? "Subiendo..." : "Guardar Avatar" }}
          </button>
          <button
            (click)="cancelAvatarUpload()"
            [disabled]="uploadingAvatar"
            class="text-xs px-2 py-1.5 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300"
          >
            Cancelar
          </button>
        </div>

        <div class="flex flex-col gap-1 mt-4">
          <a
            class="flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors"
            routerLink="/profile"
            routerLinkActive="bg-secondary/10"
            [routerLinkActiveOptions]="{ exact: true }"
            #rlaMisDatos="routerLinkActive"
          >
            <p
              class="text-sm font-medium"
              [ngClass]="{
                'text-secondary font-semibold': rlaMisDatos.isActive,
                'text-text-light-primary': !rlaMisDatos.isActive
              }"
            >
              Mis Datos
            </p>
          </a>

          <a
            class="flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-gray-100 transition-colors"
            routerLink="/profile/addresses"
            routerLinkActive="bg-secondary/10"
            #rlaDirecciones="routerLinkActive"
          >
            <p
              class="text-sm font-medium"
              [ngClass]="{
                'text-secondary font-semibold': rlaDirecciones.isActive,
                'text-text-light-primary': !rlaDirecciones.isActive
              }"
            >
              Direcciones
            </p>
          </a>

          <a
            class="flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-gray-100 transition-colors"
            routerLink="/profile/orders"
            routerLinkActive="bg-secondary/10"
            #rlaPedidos="routerLinkActive"
          >
            <p
              class="text-sm font-medium"
              [ngClass]="{
                'text-secondary font-semibold': rlaPedidos.isActive,
                'text-text-light-primary': !rlaPedidos.isActive
              }"
            >
              Historial de Pedidos
            </p>
          </a>

          <a
            class="flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-gray-100 transition-colors mt-4"
            href="#"
            (click)="onLogout($event)"
          >
            <p class="text-text-light-primary text-sm font-medium">
              Cerrar Sesi√≥n
            </p>
          </a>
        </div>
      </div>
    </aside>

    <div class="lg:w-3/4 xl:w-4/5">
      <router-outlet></router-outlet>
    </div>
  </div>
</main>
