<div
  class="flex min-h-screen w-full bg-background-light dark:bg-background-dark"
>
  <aside
    class="hidden lg:flex h-screen min-h-screen flex-col justify-between bg-white p-4 border-r border-border-light dark:border-border-dark w-64 sticky top-0"
  >
    <div class="flex flex-col gap-8">
      <a
        routerLink="/admin/dashboard"
        class="flex items-center gap-3 px-3 group focus:outline-none focus-visible:ring-2 focus-visible:ring-primary"
        aria-label="Ir al dashboard"
      >
        <div
          class="size-8 text-primary transition-transform group-hover:rotate-90"
        >
          <svg
            fill="none"
            viewBox="0 0 48 48"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              clip-rule="evenodd"
              d="M24 4H6V17.3333V30.6667H24V44H42V30.6667V17.3333H24V4Z"
              fill="#FF5A1F"
              fill-rule="evenodd"
            ></path>
          </svg>
        </div>
        <h2
          class="text-2xl font-bold leading-tight text-text-light-primary dark:text-text-dark-primary group-hover:text-primary transition-colors"
        >
          Footer
        </h2>
      </a>
      <div class="flex flex-col gap-2">
        <a
          routerLink="/admin/dashboard"
          routerLinkActive="bg-secondary/80 text-primary"
          [routerLinkActiveOptions]="{ exact: true }"
          class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
        >
          <p class="text-sm font-medium leading-normal">Dashboard</p>
        </a>
        <a
          routerLink="/admin/products"
          routerLinkActive="bg-secondary/80 text-primary"
          class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
        >
          <p class="text-sm font-medium leading-normal">Productos</p>
        </a>
        <a
          routerLink="/admin/orders"
          routerLinkActive="bg-secondary/80 text-primary"
          class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
        >
          <p class="text-sm font-medium leading-normal">Pedidos</p>
        </a>
        <a
          routerLink="/admin/users"
          routerLinkActive="bg-secondary/80 text-primary"
          class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
        >
          <p class="text-sm font-medium leading-normal">Usuarios</p>
        </a>
      </div>
    </div>
    <div
      *ngIf="user$ | async as user"
      class="flex flex-col gap-4 border-t border-border-light dark:border-border-dark pt-4"
    >
      <div class="flex gap-3 items-center">
        <img
          [src]="
            user.avatarUrl ||
            'https://placehold.co/40x40/f97306/FFFFFF?text=' +
              (user.username ? user.username.charAt(0) : 'A')
          "
          alt="Avatar del administrador"
          class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 object-cover border-2 border-primary/50"
        />
        <div class="flex flex-col overflow-hidden">
          <h1
            class="text-text-light-primary dark:text-text-dark-primary text-sm font-medium leading-normal truncate"
          >
            {{ user.username }}
          </h1>
          <p
            class="text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal"
          >
            Administrador
          </p>
        </div>
      </div>
      <button
        (click)="logout()"
        class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/80 text-text-light-secondary dark:text-text-dark-secondary w-full"
      >
        <p class="text-sm font-medium leading-normal">Cerrar Sesión</p>
      </button>
    </div>
  </aside>

  <div class="flex-1 flex flex-col w-full min-w-0">
    <header
      class="lg:hidden sticky top-0 z-30 flex items-center justify-between gap-4 px-4 h-16 bg-white dark:bg-card-dark border-b border-border-light dark:border-border-dark"
    >
      <a
        routerLink="/admin/dashboard"
        class="flex items-center gap-3 group focus:outline-none"
      >
        <div class="size-8 text-primary">
          <svg
            fill="none"
            viewBox="0 0 48 48"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              clip-rule="evenodd"
              d="M24 4H6V17.3333V30.6667H24V44H42V30.6667V17.3333H24V4Z"
              fill="#FF5A1F"
              fill-rule="evenodd"
            ></path>
          </svg>
        </div>
        <h2
          class="text-2xl font-bold leading-tight text-text-light-primary dark:text-text-dark-primary"
        >
          Footer
        </h2>
      </a>
      <button
        (click)="toggleSidebar()"
        class="text-text-light-primary dark:text-text-dark-primary p-2"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"
          />
        </svg>
      </button>
    </header>

    <main class="flex-1 p-4 md:p-8 overflow-y-auto">
      <router-outlet></router-outlet>
    </main>
  </div>

  <div *ngIf="isSidebarOpen" class="lg:hidden fixed inset-0 z-50">
    <div
      (click)="toggleSidebar()"
      class="absolute inset-0 bg-black/50 backdrop-blur-sm animate-fade-in"
    ></div>

    <aside
      class="relative z-10 flex h-full w-64 flex-col justify-between bg-white dark:bg-card-dark p-4 border-r border-border-light dark:border-border-dark animate-slide-in"
    >
      <div class="flex flex-col gap-8">
        <a
          routerLink="/admin/dashboard"
          class="flex items-center gap-3 px-3 group focus:outline-none focus-visible:ring-2 focus-visible:ring-primary"
          aria-label="Ir al dashboard"
        >
          <div
            class="size-8 text-primary transition-transform group-hover:rotate-90"
          >
            <svg
              fill="none"
              viewBox="0 0 48 48"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                clip-rule="evenodd"
                d="M24 4H6V17.3333V30.6667H24V44H42V30.6667V17.3333H24V4Z"
                fill="#FF5A1F"
                fill-rule="evenodd"
              ></path>
            </svg>
          </div>
          <h2
            class="text-2xl font-bold leading-tight text-text-light-primary dark:text-text-dark-primary group-hover:text-primary transition-colors"
          >
            Footer
          </h2>
        </a>
        <div class="flex flex-col gap-2">
          <a
            routerLink="/admin/dashboard"
            routerLinkActive="bg-secondary/80 text-primary"
            [routerLinkActiveOptions]="{ exact: true }"
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
            (click)="toggleSidebar()"
          >
            <p class="text-sm font-medium leading-normal">Dashboard</p>
          </a>
          <a
            routerLink="/admin/products"
            routerLinkActive="bg-secondary/80 text-primary"
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
            (click)="toggleSidebar()"
          >
            <p class="text-sm font-medium leading-normal">Productos</p>
          </a>
          <a
            routerLink="/admin/orders"
            routerLinkActive="bg-secondary/80 text-primary"
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
            (click)="toggleSidebar()"
          >
            <p class="text-sm font-medium leading-normal">Pedidos</p>
          </a>
          <a
            routerLink="/admin/users"
            routerLinkActive="bg-secondary/80 text-primary"
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/50 text-text-light-secondary dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary"
            (click)="toggleSidebar()"
          >
            <p class="text-sm font-medium leading-normal">Usuarios</p>
          </a>
        </div>
      </div>
      <div
        *ngIf="user$ | async as user"
        class="flex flex-col gap-4 border-t border-border-light dark:border-border-dark pt-4"
      >
        <div class="flex gap-3 items-center">
          <img
            [src]="
              user.avatarUrl ||
              'https://placehold.co/40x40/f97306/FFFFFF?text=' +
                (user.username ? user.username.charAt(0) : 'A')
            "
            alt="Avatar del administrador"
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 object-cover border-2 border-primary/50"
          />
          <div class="flex flex-col overflow-hidden">
            <h1
              class="text-text-light-primary dark:text-text-dark-primary text-sm font-medium leading-normal truncate"
            >
              {{ user.username }}
            </h1>
            <p
              class="text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal"
            >
              Administrador
            </p>
          </div>
        </div>
        <button
          (click)="logout()"
          class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-secondary/80 text-text-light-secondary dark:text-text-dark-secondary w-full"
        >
          <p class="text-sm font-medium leading-normal">Cerrar Sesión</p>
        </button>
      </div>
    </aside>
  </div>
</div>

<app-product-modal *ngIf="isProductModalOpen$ | async"></app-product-modal>
<app-edit-product-modal
  *ngIf="isEditModalOpen$ | async"
></app-edit-product-modal>
<app-product-details-modal
  *ngIf="isDetailsModalOpen$ | async"
></app-product-details-modal>
<app-delete-product-modal
  *ngIf="isDeleteModalOpen$ | async"
></app-delete-product-modal>
<app-order-details-modal
  *ngIf="isOrderDetailsModalOpen$ | async"
></app-order-details-modal>
<app-status-update-modal
  *ngIf="isStatusUpdateModalOpen$ | async"
></app-status-update-modal>
<app-delete-user-modal
  *ngIf="isDeleteUserModalOpen$ | async"
></app-delete-user-modal>

<style>
  @keyframes fade-in {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
  @keyframes slide-in {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(0);
    }
  }
  .animate-fade-in {
    animation: fade-in 0.2s ease-out;
  }
  .animate-slide-in {
    animation: slide-in 0.2s ease-out;
  }
</style>
