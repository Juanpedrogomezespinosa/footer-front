<div class="min-h-screen flex items-center justify-center bg-gray-50 p-4">
  <div class="w-full max-w-md">
    <div class="rounded-xl border border-gray-200 bg-white shadow-lg">
      <div class="p-6 sm:p-8">
        <div
          class="flex h-10 w-full items-center justify-center rounded-lg bg-gray-100 p-1 mb-6"
        >
          <button
            (click)="authMode.set('login')"
            class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all duration-200"
            [ngClass]="{
              'bg-white shadow-[0_0_4px_rgba(0,0,0,0.1)] text-primary':
                authMode() === 'login',
              'text-gray-500 hover:bg-gray-200': authMode() === 'register'
            }"
          >
            <span class="truncate">Iniciar sesión</span>
          </button>
          <button
            (click)="authMode.set('register')"
            class="flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all duration-200"
            [ngClass]="{
              'bg-white shadow-[0_0_4px_rgba(0,0,0,0.1)] text-primary':
                authMode() === 'register',
              'text-gray-500 hover:bg-gray-200': authMode() === 'login'
            }"
          >
            <span class="truncate">Registrarse</span>
          </button>
        </div>

        <div *ngIf="authMode() === 'login'" class="space-y-6">
          <div>
            <h1
              class="text-primary tracking-tight text-2xl font-bold leading-tight text-center"
            >
              Bienvenido de nuevo
            </h1>
            <p
              class="text-gray-600 text-sm font-normal leading-normal text-center mt-1"
            >
              Inicia sesión para continuar.
            </p>
          </div>

          <form
            [formGroup]="loginForm"
            (ngSubmit)="onLoginSubmit()"
            class="space-y-4"
          >
            <div>
              <label
                class="block text-primary text-sm font-medium leading-normal pb-2"
                >Email</label
              >
              <input
                formControlName="email"
                type="email"
                placeholder="tu.email@ejemplo.com"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-primary focus:outline-none focus:ring-1 focus:ring-secondary focus:border-secondary border border-gray-300 bg-white h-12 placeholder:text-gray-400 p-[15px] text-base font-normal leading-normal"
              />
              <p
                *ngIf="
                  loginForm.get('email')?.touched &&
                  loginForm.get('email')?.invalid
                "
                class="mt-1 text-xs text-red-500"
              >
                Introduce un email válido.
              </p>
            </div>

            <div>
              <div class="flex justify-between items-baseline pb-2">
                <label class="text-primary text-sm font-medium leading-normal"
                  >Contraseña</label
                >
                <a
                  routerLink="/forgot-password"
                  class="text-sm font-medium text-secondary hover:underline"
                >
                  ¿Olvidaste tu contraseña?
                </a>
              </div>
              <div class="relative flex w-full flex-1 items-stretch rounded-lg">
                <input
                  [type]="passwordFieldType"
                  formControlName="password"
                  placeholder="Introduce tu contraseña"
                  class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-primary focus:outline-none focus:ring-1 focus:ring-secondary focus:border-secondary border border-gray-300 bg-white h-12 placeholder:text-gray-400 p-[15px] rounded-r-none border-r-0 pr-2 text-base font-normal leading-normal"
                />
                <button
                  type="button"
                  (click)="togglePasswordVisibility()"
                  aria-label="Toggle password visibility"
                  class="text-gray-500 flex border border-gray-300 bg-white items-center justify-center px-3 rounded-r-lg border-l-0"
                >
                  <span
                    *ngIf="passwordFieldType === 'password'"
                    class="material-symbols-outlined text-xl"
                    >visibility</span
                  >
                  <span
                    *ngIf="passwordFieldType === 'text'"
                    class="material-symbols-outlined text-xl"
                    >visibility_off</span
                  >
                </button>
              </div>
              <p
                *ngIf="
                  loginForm.get('password')?.touched &&
                  loginForm.get('password')?.invalid
                "
                class="mt-1 text-xs text-red-500"
              >
                La contraseña es obligatoria.
              </p>
            </div>

            <div class="flex flex-col space-y-4 pt-2">
              <button
                type="submit"
                [disabled]="isLoading() || loginForm.invalid"
                class="flex items-center justify-center whitespace-nowrap rounded-lg h-12 px-6 text-sm font-bold leading-normal text-white bg-secondary hover:bg-secondary-dark transition-colors duration-200 disabled:opacity-50"
              >
                {{ isLoading() ? "Accediendo..." : "Iniciar sesión" }}
              </button>

              <a
                href="https://footer-back.onrender.com/api/auth/google"
                class="flex items-center justify-center whitespace-nowrap rounded-lg h-12 px-6 text-sm font-medium leading-normal text-primary bg-gray-50 border border-gray-300 hover:bg-gray-100 transition-colors duration-200"
              >
                <svg
                  class="w-5 h-5 mr-3"
                  viewBox="0 0 48 48"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill="#FFC107"
                    d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"
                  />
                  <path
                    fill="#FF3D00"
                    d="M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"
                  />
                  <path
                    fill="#4CAF50"
                    d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"
                  />
                  <path
                    fill="#1976D2"
                    d="M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.021 35.809 44 30.138 44 24c0-1.341-.138-2.65-.389-3.917z"
                  />
                </svg>
                Continuar con Google
              </a>
            </div>
          </form>
        </div>

        <div *ngIf="authMode() === 'register'" class="space-y-6">
          <div>
            <h1
              class="text-primary tracking-tight text-2xl font-bold leading-tight text-center"
            >
              Crea tu cuenta
            </h1>
            <p
              class="text-gray-600 text-sm font-normal leading-normal text-center mt-1"
            >
              Únete a la comunidad Footer.
            </p>
          </div>

          <form
            [formGroup]="registerForm"
            (ngSubmit)="onRegisterSubmit()"
            class="space-y-4"
          >
            <div>
              <label
                class="block text-primary text-sm font-medium leading-normal pb-2"
                >Nombre</label
              >
              <input
                formControlName="name"
                type="text"
                placeholder="Tu nombre completo"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-primary focus:outline-none focus:ring-1 focus:ring-secondary focus:border-secondary border border-gray-300 bg-white h-12 placeholder:text-gray-400 p-[15px] text-base font-normal leading-normal"
              />
              <p
                *ngIf="
                  registerForm.get('name')?.touched &&
                  registerForm.get('name')?.invalid
                "
                class="mt-1 text-xs text-red-500"
              >
                El nombre es obligatorio.
              </p>
            </div>

            <div>
              <label
                class="block text-primary text-sm font-medium leading-normal pb-2"
                >Email</label
              >
              <input
                formControlName="email"
                type="email"
                placeholder="tu.email@ejemplo.com"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-primary focus:outline-none focus:ring-1 focus:ring-secondary focus:border-secondary border border-gray-300 bg-white h-12 placeholder:text-gray-400 p-[15px] text-base font-normal leading-normal"
              />
              <p
                *ngIf="
                  registerForm.get('email')?.touched &&
                  registerForm.get('email')?.invalid
                "
                class="mt-1 text-xs text-red-500"
              >
                Introduce un email válido.
              </p>
            </div>

            <div>
              <label
                class="block text-primary text-sm font-medium leading-normal pb-2"
                >Contraseña</label
              >
              <div class="relative flex w-full flex-1 items-stretch rounded-lg">
                <input
                  [type]="passwordFieldType"
                  formControlName="password"
                  placeholder="Crea una contraseña"
                  class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-primary focus:outline-none focus:ring-1 focus:ring-secondary focus:border-secondary border border-gray-300 bg-white h-12 placeholder:text-gray-400 p-[15px] rounded-r-none border-r-0 pr-2 text-base font-normal leading-normal"
                />
                <button
                  type="button"
                  (click)="togglePasswordVisibility()"
                  aria-label="Toggle password visibility"
                  class="text-gray-500 flex border border-gray-300 bg-white items-center justify-center px-3 rounded-r-lg border-l-0"
                >
                  <span
                    *ngIf="passwordFieldType === 'password'"
                    class="material-symbols-outlined text-xl"
                    >visibility</span
                  >
                  <span
                    *ngIf="passwordFieldType === 'text'"
                    class="material-symbols-outlined text-xl"
                    >visibility_off</span
                  >
                </button>
              </div>
              <div
                *ngIf="
                  registerForm.get('password')?.touched &&
                  registerForm.get('password')?.invalid
                "
                class="mt-1 text-xs text-red-600 space-y-0.5"
              >
                <p *ngIf="registerForm.get('password')?.errors?.['required']">
                  La contraseña es obligatoria.
                </p>
                <p *ngIf="registerForm.get('password')?.errors?.['minLength']">
                  Debe tener al menos 8 caracteres.
                </p>
                <p
                  *ngIf="registerForm.get('password')?.errors?.['requireUppercase']"
                >
                  Debe incluir al menos una mayúscula.
                </p>
                <p
                  *ngIf="registerForm.get('password')?.errors?.['requireSpecialChar']"
                >
                  Debe incluir al menos un carácter especial (ej: !&#64;#$).
                </p>
              </div>
            </div>

            <div>
              <label
                class="block text-primary text-sm font-medium leading-normal pb-2"
                >Confirmar Contraseña</label
              >
              <input
                [type]="passwordFieldType"
                formControlName="confirmPassword"
                placeholder="Repite tu contraseña"
                class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-primary focus:outline-none focus:ring-1 focus:ring-secondary focus:border-secondary border border-gray-300 bg-white h-12 placeholder:text-gray-400 p-[15px] text-base font-normal leading-normal"
              />
              <p
                *ngIf="registerForm.errors?.['passwordMismatch'] && registerForm.get('confirmPassword')?.touched"
                class="mt-1 text-xs text-red-500"
              >
                Las contraseñas no coinciden.
              </p>
            </div>

            <div class="flex flex-col space-y-4 pt-2">
              <button
                type="submit"
                [disabled]="isLoading() || registerForm.invalid"
                class="flex items-center justify-center whitespace-nowrap rounded-lg h-12 px-6 text-sm font-bold leading-normal text-white bg-secondary hover:bg-secondary-dark transition-colors duration-200 disabled:opacity-50"
              >
                {{ isLoading() ? "Creando cuenta..." : "Crear cuenta" }}
              </button>

              <a
                href="https://footer-back.onrender.com/api/auth/google"
                class="flex items-center justify-center whitespace-nowrap rounded-lg h-12 px-6 text-sm font-medium leading-normal text-primary bg-gray-50 border border-gray-300 hover:bg-gray-100 transition-colors duration-200"
              >
                <svg
                  class="w-5 h-5 mr-3"
                  viewBox="0 0 48 48"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill="#FFC107"
                    d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"
                  />
                  <path
                    fill="#FF3D00"
                    d="M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z"
                  />
                  <path
                    fill="#4CAF50"
                    d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"
                  />
                  <path
                    fill="#1976D2"
                    d="M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.021 35.809 44 30.138 44 24c0-1.341-.138-2.65-.389-3.917z"
                  />
                </svg>
                Continuar con Google
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
