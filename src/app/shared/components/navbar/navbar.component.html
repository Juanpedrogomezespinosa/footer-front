<nav
  class="w-full bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm"
  role="navigation"
  aria-label="Navegación principal"
  (document:click)="handleDocumentClick($event)"
>
  <div class="max-w-6xl mx-auto flex justify-between items-center px-4 py-3">
    <!-- Logo -->
    <a
      routerLink="/home"
      (click)="$event.preventDefault(); reloadPage()"
      class="flex items-center gap-2"
    >
      <img
        src="/assets/logo-2.png"
        alt="Logo de la aplicación"
        class="w-10 sm:w-10"
      />
    </a>

    <!-- Buscador escritorio -->
    <div
      class="hidden md:flex items-center border border-gray-300 rounded-full px-3 py-1.5 focus-within:ring-2 focus-within:ring-secondary transition"
      [class.ring-2]="searchActive"
      role="search"
    >
      <input
        id="search-input"
        type="search"
        placeholder="Buscar productos..."
        class="outline-none px-2 w-48 sm:w-64 md:w-80"
        (keydown.enter)="submitSearch()"
        [(ngModel)]="searchTerm"
        #searchInput
      />
      <button
        type="button"
        (click)="searchActive ? submitSearch() : toggleSearch()"
        [attr.aria-label]="
          searchActive ? 'Cerrar búsqueda' : 'Buscar productos'
        "
      >
        <img
          src="/assets/icons/lupa.svg"
          alt="Buscar"
          class="w-5 h-5 opacity-70"
        />
      </button>
    </div>

    <!-- Iconos -->
    <div class="flex items-center gap-4">
      <ng-container *ngIf="isLoggedIn; else guestIcons">
        <a
          routerLink="/cart"
          aria-label="Carrito"
          class="hover:opacity-70 transition"
        >
          <img src="/assets/icons/carrito.svg" alt="Carrito" class="w-6 h-6" />
        </a>
        <a
          routerLink="/profile"
          aria-label="Perfil"
          class="hover:opacity-70 transition"
        >
          <img src="/assets/icons/perfil.svg" alt="Perfil" class="w-6 h-6" />
        </a>
        <button
          (click)="logout()"
          aria-label="Cerrar sesión"
          class="hover:opacity-70 transition"
        >
          <img src="/assets/icons/logout.svg" alt="Logout" class="w-6 h-6" />
        </button>
      </ng-container>

      <ng-template #guestIcons>
        <a
          routerLink="/login"
          aria-label="Iniciar sesión"
          class="hover:opacity-70 transition"
        >
          <img src="/assets/icons/login.svg" alt="Login" class="w-6 h-6" />
        </a>
      </ng-template>

      <!-- Botón menú móvil -->
      <button
        class="md:hidden hover:opacity-70 transition"
        (click)="toggleMobileMenu()"
        aria-label="Abrir menú"
        #menuToggleButton
      >
        <img src="/assets/icons/menu.svg" alt="Menú" class="w-6 h-6" />
      </button>
    </div>
  </div>

  <!-- Menú móvil -->
  <div
    *ngIf="mobileMenuActive"
    class="md:hidden bg-white border-t border-gray-200 shadow-lg"
  >
    <div class="flex flex-col p-4 space-y-3">
      <ng-container *ngIf="isLoggedIn; else guestMenu">
        <a
          routerLink="/cart"
          class="text-gray-700 hover:text-secondary transition"
          >Carrito</a
        >
        <a
          routerLink="/profile"
          class="text-gray-700 hover:text-secondary transition"
          >Perfil</a
        >
        <a
          href="#"
          (click)="$event.preventDefault(); logout()"
          class="text-gray-700 hover:text-secondary transition"
          >Cerrar sesión</a
        >
      </ng-container>

      <ng-template #guestMenu>
        <a
          routerLink="/login"
          class="text-gray-700 hover:text-secondary transition"
          >Iniciar sesión</a
        >
        <a
          routerLink="/register"
          class="text-gray-700 hover:text-secondary transition"
          >Registrarse</a
        >
      </ng-template>
    </div>
  </div>
</nav>
