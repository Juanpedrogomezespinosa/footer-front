<header
  class="sticky top-0 z-50 w-full bg-card-light/80 dark:bg-card-dark/80 backdrop-blur-sm border-b border-subtle-light dark:border-subtle-dark"
>
  <div
    class="flex items-center justify-between px-4 sm:px-10 py-3 max-w-7xl mx-auto"
  >
    <!-- IZQUIERDA -->
    <a
      routerLink="/home"
      class="flex items-center gap-3"
      aria-label="Ir al inicio"
    >
      <div class="size-6 text-secondary">
        <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <path
            clip-rule="evenodd"
            d="M24 4H6V17.3333V30.6667H24V44H42V30.6667V17.3333H24V4Z"
            fill="currentColor"
            fill-rule="evenodd"
          ></path>
        </svg>
      </div>
      <h2
        class="text-lg font-bold leading-tight tracking-[-0.015em] text-gray-800 hover:text-primary-dark transition"
      >
        Footer
      </h2>
    </a>

    <!-- DERECHA -->
    <div class="flex items-center gap-3">
      <!-- Buscador -->
      <div class="relative">
        <button
          type="button"
          (click)="toggleSearchDesktop()"
          aria-label="Buscar productos"
          class="search-button flex items-center justify-center h-10 w-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition"
        >
          <img src="/assets/icons/lupa.svg" alt="Buscar" class="w-5 h-5" />
        </button>

        <!-- DESPLEGABLE buscador desktop -->
        <form
          *ngIf="searchActiveDesktop"
          (ngSubmit)="submitSearch()"
          class="search-desktop-wrapper absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm p-2"
        >
          <div class="flex items-center gap-2 px-2 py-1">
            <img
              src="/assets/icons/lupa.svg"
              alt="Buscar"
              class="w-4 h-4 opacity-60"
            />
            <input
              #searchInputDesktop
              type="search"
              placeholder="Buscar productos..."
              [(ngModel)]="searchTerm"
              name="search"
              class="bg-transparent outline-none w-full text-sm text-gray-700 dark:text-gray-200"
            />
            <button
              type="submit"
              aria-label="Enviar búsqueda"
              class="text-primary text-sm font-medium px-2 hover:opacity-70 transition"
            >
              OK
            </button>
          </div>
        </form>
      </div>

      <!-- Carrito -->
      <a
        routerLink="/cart"
        aria-label="Carrito"
        class="flex items-center justify-center h-10 w-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition"
      >
        <img src="/assets/icons/carrito.svg" alt="Carrito" class="w-5 h-5" />
      </a>

      <!-- Perfil -->
      <a
        routerLink="/profile"
        aria-label="Perfil"
        class="flex items-center justify-center h-10 w-10 rounded-full overflow-hidden hover:opacity-80 transition"
      >
        <div
          class="bg-center bg-cover aspect-square w-8 h-8 rounded-full"
          [style.background-image]="'url(' + userAvatarUrl + ')'"
          role="img"
        ></div>
      </a>

      <!-- Login / Logout -->
      <ng-container *ngIf="isLoggedIn; else loginIcon">
        <button
          (click)="logout()"
          aria-label="Cerrar sesión"
          class="flex items-center justify-center h-10 w-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition"
        >
          <img
            src="/assets/icons/logout.svg"
            alt="Cerrar sesión"
            class="w-5 h-5"
          />
        </button>
      </ng-container>

      <ng-template #loginIcon>
        <a
          routerLink="/login"
          aria-label="Iniciar sesión"
          class="flex items-center justify-center h-10 w-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition"
        >
          <img
            src="/assets/icons/login.svg"
            alt="Iniciar sesión"
            class="w-5 h-5"
          />
        </a>
      </ng-template>

      <!-- Menú móvil -->
      <button
        class="md:hidden flex items-center justify-center h-10 w-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition"
        (click)="toggleMobileMenu()"
        aria-label="Abrir menú"
      >
        <img src="/assets/icons/menu.svg" alt="Menú" class="w-6 h-6" />
      </button>
    </div>
  </div>

  <!-- MENÚ MÓVIL -->
  <div
    *ngIf="mobileMenuActive"
    class="md:hidden mobile-menu bg-card-light dark:bg-card-dark border-t border-subtle-light dark:border-subtle-dark"
  >
    <div class="flex flex-col p-4 space-y-3">
      <!-- Buscador móvil -->
      <form
        (ngSubmit)="submitSearch()"
        class="flex items-center bg-background-light dark:bg-background-dark rounded-lg h-10 px-3 gap-2"
      >
        <img
          src="/assets/icons/lupa.svg"
          alt="Buscar"
          class="w-4 h-4 opacity-60"
        />
        <input
          type="search"
          placeholder="Buscar productos..."
          [(ngModel)]="searchTerm"
          name="mobileSearch"
          class="bg-transparent w-full outline-none text-sm text-gray-700 dark:text-gray-200"
        />
      </form>

      <a
        routerLink="/cart"
        class="text-gray-700 dark:text-gray-200 hover:text-primary transition"
        >Carrito</a
      >
      <a
        routerLink="/profile"
        class="text-gray-700 dark:text-gray-200 hover:text-primary transition"
        >Perfil</a
      >

      <ng-container *ngIf="isLoggedIn; else guestMenu">
        <a
          href="#"
          (click)="$event.preventDefault(); logout()"
          class="text-gray-700 dark:text-gray-200 hover:text-primary transition"
          >Cerrar sesión</a
        >
      </ng-container>

      <ng-template #guestMenu>
        <a
          routerLink="/login"
          class="text-gray-700 dark:text-gray-200 hover:text-primary transition"
          >Iniciar sesión</a
        >
        <a
          routerLink="/register"
          class="text-gray-700 dark:text-gray-200 hover:text-primary transition"
          >Registrarse</a
        >
      </ng-template>
    </div>
  </div>
</header>
